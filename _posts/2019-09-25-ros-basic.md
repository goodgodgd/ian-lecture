---
layout: post
title:  "Introduction to ROS"
date:   2010-09-25 09:00:13
categories: WIP
---



# ROS 개념

## 1. ROS 용어

- ROS: 로봇 응용프로그램을 개발하기 위한 로봇 소프트웨어 플랫폼이다. 로봇 응용프로그램을 개발에 필요한 다양한 기능을 제공한다.
    - 하드웨어 추상화, 디바이스 제어
    - 로보틱스에서 자주 사용되는 센싱, 인식, 지도작성, 경로계획 등의 구현
    - 프로세스 간의 메시지 통신
    - 패키지 관리
    - 다양한 개발 및 디버깅 도구 (catkin 등)
- 마스터(Master): 노드 사이의 연결과 메시지 통신을 위한 서버 역할을 한다. 마스터가 실행 중이어야 노드 사이의 통신이 가능하다. `roscore` 명령어로 실행한다.
- 노드(Node): 최소 단위의 실행 가능한 프로세스 혹은 프로그램이다. ROS 에서는 하나의 목적에 하나의 노드를 작성하길 권하며 그래야 노드를 재사용하기 쉽다. 노드 사이에는 메시지 통신으로 데이터를 주고 받는다.
- 패키지(Package): ROS를 구성하는 기본 단위다. ROS 응용 프로그램은 패키지 단위로 개발되는데 패키지는 하나 이상의 노드를 포함하거나, 다른 패키지의 노드 실행을 위한 설정 파일 등을 포함한다.
- 메시지(Message): 노드 사이에서 주고 받는 데이터 형식이다. int, float 같은 기본 변수 형태부터 시작해서 메시지 안에 다른 메시지를 품은 데이터 구조도 가능하고 메시지의 배열도 사용 가능하다.
- 파라미터(parameter): 마스터에서 관리하는 노드 사이에 공유되는 설정 값이다. 파라미터는 기본값이 있고 노드에서 수정도 가능하다.
- 네임(Name): 노드, 파라미터, 토픽, 서비스에는 모두 네임이 있다. 네임은 ROS 요소들끼리 서로를 식별하는 ID같은 역할을 한다. 그래서 같은 노드라 할지라도 두 개를 중복 실행하려면 네임을 다르게 지정해야한다.



## 2. 메시지 통신 방식

### 2.1토픽 (Topic)

- **용도**: **토픽은 주기적으로 발생하는 메시지를 지속적으로 전송하는 단방향 통신** 방식이다. 주로 센서 데이터를 알고리즘 노드로 보내거나 센서 주기에 맞춰 한 알고리즘에서 처리된 데이터를 다음 알고리즘으로 보낼때 많이 사용된다.  
- **구성**: 토픽에는 메시지를 보내는 **퍼블리셔**(Publisher, 발행자)와 메시지를 수신하는 **서브스크라이버**(Subscriber, 구독자)가 있다. 하나의 노드에서 다수의 퍼블리셔나 다수의 서브스크라이버를 가질 수 있고 두 가지 다 가질 수도 있다.  
- **방식**: 퍼블리셔 노드는 발행하는 토픽 정보를 마스터에 등록한다. 서브스크라이버 노드는 구독할 토픽을 발행하는 퍼블리셔 노드 정보를 마스터에서 받는다. 서브스크라이버는 퍼블리셔에 직접 접속하여 메시지를 받게 된다.

### 2.2 서비스 (Service)

- **용도**: **서비스는 일회성 요청(메시지)을 보내고 응답(메시지)을 받는 양방향 통신** 방식이다. 주로 특정 조건을 만족했을 때 이를 알리거나 그에 따른 명령을 내리는 수단으로 사용된다.
- **구성**: 서비스를 **요청(request)**하는 **서비스 클라이언트(service client)**와 요청에 대한 **응답(response)**를 해주는 **서비스 서버( service server)**로 구성된다. 
- **방식**: 서비스 서버는 수신할 서비스 메시지를 마스터에 등록한다. 서비스 클라이언트는 마스터에서 메시지를 받을 수 있는 서버 노드를 찾고 요청 메시지를 보낸다. 서버는 요청이 들어오면 이를 처리한 응답 메시지를 클라이언트로 보낸다.

### 2.3 액션 (Action)

- **용도**: **액션은 요청 후 결과를 받기 전에 중간 결과를 받을 수 있는 양방향 통신** 방식이다. 주로 요청 후 응답까지 오랜 시간이 걸리고 중간 결과나 진행상황을 보내야할 때 사용된다.
- **구성**: 서비스처럼 액션도 **액션 서버(action server**와 **액션 클라이언트(action client)**가 있다. 
- **방식**: 액션 클라이언트에서 **목표(goal)**을 보내면 액션 서버에서는 이를 처리하며 중간 결과인 **피드백(feedback)**을 보내고 처리가 끝나면 **결과(result)**를 보낸다.

### 2.4 요약

| 방식   | 동기화 | 방향   | 용도                 |
| ------ | ------ | ------ | -------------------- |
| 토픽   | 비동기 | 단방향 | 지속적인 데이터 전송 |
| 서비스 | 동기   | 양방향 | 일시적인 양방향 통신 |
| 액션   | 동기   | 양방향 | 중간 피드백 제공     |



# ROS 명령어







- ROS bash
    - rosrun
    - roscd, rostopic, ...
    - rosbag
- Catkin Workspace
    - 리눅스 빌드 시스템 gcc make cmake
    - 기존 catkin vs 새로운 catkin
    - catkin verbs
- 파이썬 가상환경: virutalenv, pyenv, pipenv
- 패키지 만들기
    - 토픽 노드: 기존 메시지 활용
    - 토픽 노드: 새로운 메시지 만들기
    - 서비스 노드: 기존 메시지 활용
    - 서비스 노드: 새로운 메시지 만들기
    - ROS launch 작성
- git을 이용한 패키지 관리

...

- 좌표계변환
- numpy, matplotlib
- ROS 패키지 활용 (SLAM, RViz)

