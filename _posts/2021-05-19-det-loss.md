---
layout: post
title:  "[Det] Loss Functions"
date:   2021-05-19 09:00:13
categories: 2021-1-detector
---



## 1. Detector Loss

손실 함수(loss function)란 모델의 출력(예측, Prediction)과 Ground Truth(GT, Annotation, Label) 사이의 차이를 나타내는 함수다. 모델 학습은 이 손실 함수를 줄이기 위해 신경망의 파라미터들을 업데이트 한다. 모델 예측과 GT 사이의 직접적인 차이를 손실함수로 쓸 수도 있지만 (e.g. $||x-y||, ||x-y||^2$) Cross Entropy처럼 간접적으로 둘 사이의 차이에 비례하여 커지는 다른 함수를 사용할 수도 있다. 

Object Detector는 검출, 분류, 회귀(regression) 세 가지 기능을 하고 세 가지 예측이 모두 맞아야 객체를 제대로 찾을 수 있다. 따라서 손실 함수가 하나의 함수로 이뤄지지 않고 여러 손실 함수의 합으로 전체 손실 함수가 만들어진다. 다음은 Object Detector의 세 가지 기능에 대한 설명이다.

- 검출: 모델이 출력한 multi-scale feature map에서 scale * grid_y * grid_x * anchor 마다 객체가 있는지 없는지 **Objectness**를 구분한다. Objectness는 0~1 사이의 확률값으로 출력한다.
- 분류: 모델에서 출력된 객체마다 객체의 종류를 분류한다. 각 객체 출력은 K(카테고리 개수) 차원의 **Categorical Probability**를 포함한다.
- 회귀: 검출 모델은 객체를 감싸는 **Bounding Box**를 예측한다. Bounding Box는 위치(y, x)와 크기(h, w)로 나타내는데 이미지 너비, 높이를 1로 가정하여 위치와 크기를 0~1 사이의 값으로 출력한다.

이제 각각의 기능을 학습시키는 다양한 손실 함수에 대해서 알아보자. 같은 기능을 학습시켜도 논문마다 다양한 손실 함수를 제안하고 있으니 여러가지를 시도해보는게 좋다.

### 1.1. Bounding Box





### 1.2. Objectness



### 1.3. Categorical Probability

yolo v1 vs v3





## 2. Training Log





